# Evoki Emergency Detection API - Visual Guide

**Status:** âœ… PRODUKTIONSREIFE | **Version:** 1.0 | **Datum:** 2025-12-07

---

## ğŸ¨ System-Architektur

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EVOKI EMERGENCY DETECTION API                         â”‚
â”‚                            Version 1.0                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      EXTERNAL SYSTEMS (Integration Points)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”œâ”€ 112 / Notfall-Zentren                                              â”‚
â”‚  â”œâ”€ evoki_engine_v11.py (Main Engine)                                  â”‚
â”‚  â”œâ”€ Monitoring Dashboards                                              â”‚
â”‚  â”œâ”€ Logging Systems                                                    â”‚
â”‚  â””â”€ Operator Consoles                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    REST API SERVER (Flask)                              â”‚
â”‚                         Port 5000                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”œâ”€ POST   /api/v1/emergency/detect                                   â”‚
â”‚  â”œâ”€ GET    /api/v1/emergency/status                                   â”‚
â”‚  â”œâ”€ GET    /api/v1/emergency/rules                                    â”‚
â”‚  â”œâ”€ GET    /api/v1/emergency/log                                      â”‚
â”‚  â”œâ”€ POST   /api/v1/emergency/reset                                    â”‚
â”‚  â””â”€ GET    /api/v1/health                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EmergencyDetectionAPI (Core Logic)                         â”‚
â”‚           File: emergency_detection_api.py (300 LOC)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  detect_emergency(user_input) â”€â”€â”                                      â”‚
â”‚                                 â”œâ”€â”€â†’ [Keyword Matching]                â”‚
â”‚  generate_response(report)   â”€â”€â”€â”¤     â””â”€â”€â†’ 8 Kategorien               â”‚
â”‚                                 â”‚          (112, Suizid, etc.)        â”‚
â”‚  get_emergency_status()     â”€â”€â”€â”€â”¤                                       â”‚
â”‚                                 â”œâ”€â”€â†’ [Rule Engine]                     â”‚
â”‚  reset_emergency()          â”€â”€â”€â”€â”˜     â””â”€â”€â†’ 6 Evoki-Regeln             â”‚
â”‚                                           (A_EMERGENCY_001-006)       â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Keyword Matching Engine                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  notruf_explicit: [112, notruf]              â†’ CRITICAL (0s)           â”‚
â”‚  suicidal: [suizid, selbstmord]              â†’ CRITICAL (0s)           â”‚
â”‚  harm_threat: [verletzung, blutung]          â†’ CRITICAL (0s)           â”‚
â”‚  abuse: [missbrauch, misshandlung]           â†’ CRITICAL (0s)           â”‚
â”‚  death_threat: [sterben, tod]                â†’ CRITICAL (0s)           â”‚
â”‚  help_urgent: [hilfe, brauche hilfe]         â†’ HIGH (<1min)            â”‚
â”‚  wait_signal: [warte, stop, pause]           â†’ MEDIUM (âˆ)              â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Evoki Rule Engine                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  A_EMERGENCY_001: Recognition             Timeout: 0s                  â”‚
â”‚  A_EMERGENCY_002: Hilfserufe               Timeout: <1min              â”‚
â”‚  A_EMERGENCY_003: Warte-Signale            Timeout: âˆ                  â”‚
â”‚  A_EMERGENCY_004: Kontext-Sicherung        Timeout: <100ms             â”‚
â”‚  A_EMERGENCY_005: Watcher-Veto             Timeout: 0s                 â”‚
â”‚  A_EMERGENCY_006: Keine KI-Emotion         Timeout: wÃ¤hrend Phase      â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Severity Classification                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  CRITICAL ğŸ”´: Sofortiges Alert + Watcher-Veto                          â”‚
â”‚  HIGH ğŸŸ :     Human Review erforderlich                                 â”‚
â”‚  MEDIUM ğŸŸ¡:   Pause + Warten                                           â”‚
â”‚  NONE ğŸŸ¢:     Normale Verarbeitung                                     â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Response Generation & Logging                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  - Generate KI-Response (severity-specific)                            â”‚
â”‚  - Save to Emergency Log                                               â”‚
â”‚  - Update State & Counters                                             â”‚
â”‚  - Trigger Watcher-Veto if CRITICAL                                    â”‚
â”‚  - Return JSON Response                                                â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            State & Persistence Layer                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”œâ”€ Emergency Log (JSON)                                               â”‚
â”‚  â”œâ”€ Active Emergency Counter                                           â”‚
â”‚  â”œâ”€ Severity Counters (CRITICAL/HIGH/MEDIUM/NONE)                     â”‚
â”‚  â”œâ”€ Watcher-Veto Status                                                â”‚
â”‚  â”œâ”€ Response Queue                                                     â”‚
â”‚  â””â”€ Performance Metrics                                                â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request/Response Flow (Detailliert)

```
USER INPUT
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ receive_request()    â”‚
â”‚ POST /detect         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ validate_input()                         â”‚
â”‚ - Check if user_input is not empty       â”‚
â”‚ - Check if timestamp is valid (optional) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â”œâ”€ NO â”€â”€â†’ Return 400 Bad Request
   â”‚
   â–¼ YES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ detect_emergency(user_input)             â”‚
â”‚                                          â”‚
â”‚ 1. Check each keyword category           â”‚
â”‚    - notruf_explicit?  â†’ CRITICAL        â”‚
â”‚    - suicidal?         â†’ CRITICAL        â”‚
â”‚    - harm_threat?      â†’ CRITICAL        â”‚
â”‚    - abuse?            â†’ CRITICAL        â”‚
â”‚    - death_threat?     â†’ CRITICAL        â”‚
â”‚    - help_urgent?      â†’ HIGH            â”‚
â”‚    - wait_signal?      â†’ MEDIUM          â”‚
â”‚    - none found?       â†’ NONE            â”‚
â”‚                                          â”‚
â”‚ 2. Set severity_level based on match     â”‚
â”‚ 3. Create report dict                    â”‚
â”‚    - timestamp                           â”‚
â”‚    - severity_level                      â”‚
â”‚    - is_emergency (if severity > NONE)   â”‚
â”‚    - detected_keywords                   â”‚
â”‚    - required_action                     â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ trigger_emergency_protocol()             â”‚
â”‚ (if is_emergency == True)                â”‚
â”‚                                          â”‚
â”‚ - Call all triggered rules               â”‚
â”‚ - A_EMERGENCY_001 (Recognition)          â”‚
â”‚ - A_EMERGENCY_002 (Help)                 â”‚
â”‚ - A_EMERGENCY_003 (Wait)                 â”‚
â”‚ - A_EMERGENCY_004 (Backup context)       â”‚
â”‚ - A_EMERGENCY_005 (Watcher-Veto if CRIT) â”‚
â”‚ - A_EMERGENCY_006 (No emotion)           â”‚
â”‚                                          â”‚
â”‚ - Update active_emergencies counter      â”‚
â”‚ - Set watcher_veto_active = true (CRIT)  â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ generate_response(report)                â”‚
â”‚                                          â”‚
â”‚ CRITICAL:                                â”‚
â”‚  "NOTFALL ERKANNT - SOFORT..."          â”‚
â”‚  "[A7.5 WÃ„CHTER-VETO AKTIVIERT]"        â”‚
â”‚  "Regelwerk: A_EMERGENCY_001-005"        â”‚
â”‚                                          â”‚
â”‚ HIGH:                                    â”‚
â”‚  "NOTFALL ERKANNT - Menschliche..."      â”‚
â”‚  "Operatoren werden benachrichtigt"      â”‚
â”‚                                          â”‚
â”‚ MEDIUM:                                  â”‚
â”‚  "Ich erkenne, dass du um Geduld..."     â”‚
â”‚  "Ich warte auf dein Signal"             â”‚
â”‚                                          â”‚
â”‚ NONE:                                    â”‚
â”‚  "Keine Notfall-Situation erkannt"       â”‚
â”‚  "Normale Verarbeitung..."               â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ log_emergency(report)                    â”‚
â”‚ - Add timestamp                          â”‚
â”‚ - Write to emergency_log                 â”‚
â”‚ - Update counters                        â”‚
â”‚ - Save to JSON file                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ serialize_response()                     â”‚
â”‚                                          â”‚
â”‚ {                                        â”‚
â”‚   "timestamp": "2025-12-07T11:38:20",   â”‚
â”‚   "severity_level": "CRITICAL|HIGH|...", â”‚
â”‚   "is_emergency": true|false,            â”‚
â”‚   "required_action": "IMMEDIATE_ALERT"..â”‚
â”‚   "keywords_found": 3,                   â”‚
â”‚   "detected_keywords": [...],            â”‚
â”‚   "ki_response": "NOTFALL...",          â”‚
â”‚   "watcher_veto_active": true,           â”‚
â”‚   "rules_triggered": [...]               â”‚
â”‚ }                                        â”‚
â”‚                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ send_response()                          â”‚
â”‚ HTTP 200 OK                              â”‚
â”‚ Content-Type: application/json           â”‚
â”‚ Body: JSON report                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   â”‚
   â–¼
EXTERNAL SYSTEM
(evoki_engine, monitoring dashboard, etc.)
```

---

## ğŸ“Š Severity Level Flowchart

```
User Input
    â”‚
    â–¼
Check: Keywords found?
    â”‚
    â”œâ”€ NO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                                   â”‚
    â–¼ YES                               â”‚
Check: notruf_explicit OR              â”‚
       suicidal OR                      â”‚
       harm_threat OR                   â”‚
       abuse OR                         â”‚
       death_threat?                    â”‚
    â”‚                                   â”‚
    â”œâ”€ YES â”€â”€â†’ CRITICAL ğŸ”´             â”‚
    â”‚          Timeout: 0s              â”‚
    â”‚          Action: IMMEDIATE_ALERT  â”‚
    â”‚          Watcher-Veto: YES        â”‚
    â”‚                                   â”‚
    â”‚          â”œâ”€ A_EMERGENCY_001 âœ“    â”‚
    â”‚          â”œâ”€ A_EMERGENCY_004 âœ“    â”‚
    â”‚          â”œâ”€ A_EMERGENCY_005 âœ“    â”‚
    â”‚          â””â”€ A_EMERGENCY_006 âœ“    â”‚
    â”‚                                   â”‚
    â–¼ NO                                â”‚
Check: help_urgent?                     â”‚
    â”‚                                   â”‚
    â”œâ”€ YES â”€â”€â†’ HIGH ğŸŸ                   â”‚
    â”‚          Timeout: <1 min          â”‚
    â”‚          Action: ALERT_HUMAN      â”‚
    â”‚          Watcher-Veto: NO         â”‚
    â”‚                                   â”‚
    â”‚          â”œâ”€ A_EMERGENCY_002 âœ“    â”‚
    â”‚          â””â”€ A_EMERGENCY_004 âœ“    â”‚
    â”‚                                   â”‚
    â–¼ NO                                â”‚
Check: wait_signal?                     â”‚
    â”‚                                   â”‚
    â”œâ”€ YES â”€â”€â†’ MEDIUM ğŸŸ¡               â”‚
    â”‚          Timeout: âˆ               â”‚
    â”‚          Action: HOLD_RESPONSE    â”‚
    â”‚          Watcher-Veto: NO         â”‚
    â”‚                                   â”‚
    â”‚          â””â”€ A_EMERGENCY_003 âœ“    â”‚
    â”‚                                   â”‚
    â–¼ NO                                â”‚
    â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â””â”€â†’ NONE ğŸŸ¢
        Timeout: âˆ
        Action: CONTINUE
        Watcher-Veto: NO
        
        â””â”€ Normal Processing
```

---

## ğŸ§ª Test Coverage Matrix

```
Test Suite: 14 Tests | Pass Rate: 100% âœ…

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CATEGORY          â”‚ TEST CASE          â”‚ RESULT    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Connectivity      â”‚ Health Check       â”‚ âœ… PASS   â”‚
â”‚                   â”‚ Status Pre-test    â”‚ âœ… PASS   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Rules & Config    â”‚ Get Rules          â”‚ âœ… PASS   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ CRITICAL Cases    â”‚ 112 + Hilfe        â”‚ âœ… PASS   â”‚
â”‚ (0 second)        â”‚ Suizid + Hilfe     â”‚ âœ… PASS   â”‚
â”‚                   â”‚ Verletzung         â”‚ âœ… PASS   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ HIGH Cases        â”‚ Help Request       â”‚ âœ… PASS   â”‚
â”‚ (<1 minute)       â”‚                    â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MEDIUM Cases      â”‚ Wait Signal        â”‚ âœ… PASS   â”‚
â”‚ (Infinite)        â”‚                    â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ NONE Cases        â”‚ Normal Input       â”‚ âœ… PASS   â”‚
â”‚ (Normal)          â”‚                    â”‚           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Logging & State   â”‚ Status Post-test   â”‚ âœ… PASS   â”‚
â”‚                   â”‚ Log Retrieval      â”‚ âœ… PASS   â”‚
â”‚                   â”‚ Reset              â”‚ âœ… PASS   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Overall: 14/14 = 100% âœ…
```

---

## ğŸ“ˆ Performance Visualization

```
Response Time Breakdown (Per Request)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Total: ~5-10 ms                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                            â”‚
â”‚ Keyword Matching     â–ˆâ–ˆâ–ˆâ–ˆ 1-2 ms           â”‚
â”‚ Rule Engine          â–ˆâ–ˆ 0.5-1 ms           â”‚
â”‚ Response Generation  â–ˆâ–ˆâ–ˆâ–ˆâ–‘ 2-3 ms          â”‚
â”‚ Logging             â–‘ 0.5 ms               â”‚
â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Throughput Capacity

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Concurrent Requests: ~100-200              â”‚
â”‚ Throughput: ~20,000 req/min                â”‚
â”‚ Memory: ~50 MB                             â”‚
â”‚ CPU (idle): <1%                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“š Documentation Dependency Graph

```
START HERE
    â”‚
    â”œâ”€â†’ README_EMERGENCY_API.md (QUICK START)
    â”‚    â”‚
    â”‚    â”œâ”€â†’ 1-Minute Quickstart
    â”‚    â”œâ”€â†’ API Overview
    â”‚    â””â”€â†’ Troubleshooting
    â”‚
    â”œâ”€â†’ EMERGENCY_API_QUICKREF.md (REFERENCE)
    â”‚    â”‚
    â”‚    â”œâ”€â†’ Spickzettel
    â”‚    â”œâ”€â†’ Keywords Table
    â”‚    â””â”€â†’ Endpoint Cheat-Sheet
    â”‚
    â””â”€â†’ EMERGENCY_API_DOCUMENTATION_COMPLETE.md (DEEP DIVE)
         â”‚
         â”œâ”€â†’ Full Architecture
         â”œâ”€â†’ All 6 Endpoints (with Examples)
         â”œâ”€â†’ All 8 Keywords
         â”œâ”€â†’ All 6 Evoki Rules
         â””â”€â†’ Integration Guide
```

---

## ğŸ¯ Integrations-Decision Tree

```
What is your deployment scenario?

    â”œâ”€ Single Server / Direct Integration
    â”‚  â””â”€â†’ Option 1: Direct Embedding (RECOMMENDED)
    â”‚      â””â”€ Best for: Single-server setups
    â”‚      â”” Benefits: No latency, full control
    â”‚      â”” Effort: Minimal
    â”‚
    â”œâ”€ Distributed / Microservices
    â”‚  â””â”€â†’ Option 2: Remote REST API
    â”‚      â””â”€ Best for: Separate services
    â”‚      â””â”€ Benefits: Scalability, load balancing
    â”‚      â””â”€ Effort: Moderate
    â”‚
    â”œâ”€ Need Fault Tolerance?
    â”‚  â””â”€â†’ Option 3: Hybrid (Local + Remote)
    â”‚      â””â”€ Best for: Critical systems
    â”‚      â””â”€ Benefits: Fallback, reliability
    â”‚      â””â”€ Effort: High
    â”‚
    â””â”€ Complex Flask Application?
       â””â”€â†’ Option 4: Context Manager
           â””â”€ Best for: Large projects
           â””â”€ Benefits: Pythonic, resource mgmt
           â””â”€ Effort: Moderate
```

---

## ğŸ”’ Security Architecture

```
Layer 1: Input Validation
    â”œâ”€ Check user_input not empty
    â””â”€ Validate JSON format

Layer 2: Keyword Matching
    â”œâ”€ 8 categories of known keywords
    â””â”€ No arbitrary code execution

Layer 3: Rule Processing
    â”œâ”€ Predefined Evoki rules
    â””â”€ Deterministic decision making

Layer 4: Output Sanitization
    â”œâ”€ JSON serialization only
    â””â”€ No raw user input in response

Layer 5: Logging
    â”œâ”€ Sensitive data handling
    â”œâ”€ Audit trail
    â””â”€ GDPR compliance

Layer 6: Watcher-Veto
    â””â”€ Override normal processing for CRITICAL
```

---

## ğŸš€ Deployment Paths

```
Development
    â”‚
    â”œâ”€â†’ python emergency_api_server.py
    â””â”€â†’ Testing on localhost:5000

Testing
    â”‚
    â”œâ”€â†’ Run test_emergency_api.py
    â””â”€â†’ Verify 14/14 tests pass âœ…

Staging
    â”‚
    â”œâ”€â†’ Deploy on test server
    â”œâ”€â†’ Run integration tests
    â””â”€â†’ Monitor performance

Production
    â”‚
    â”œâ”€â†’ Deploy on production server
    â”œâ”€â†’ Enable HTTPS (TLS/SSL)
    â”œâ”€â†’ Set up monitoring
    â”œâ”€â†’ Configure rate limiting
    â””â”€â†’ Enable 24/7 alerting
```

---

## ğŸ“ Quick Support Map

```
Having a problem? Follow this map:

Is the API not responding?
â”œâ”€ YES â†’ Check if server is running
â”‚        â””â”€ python emergency_api_server.py
â””â”€ NO â†’ Proceed

Getting 400 errors?
â”œâ”€ YES â†’ Check JSON syntax
â”‚        â””â”€ {"user_input": "your text"}
â””â”€ NO â†’ Proceed

Tests failing?
â”œâ”€ YES â†’ Read README_EMERGENCY_API.md
â”‚        â†’ Troubleshooting section
â””â”€ NO â†’ Proceed

Need to understand architecture?
â”œâ”€ YES â†’ Read EMERGENCY_API_DOCUMENTATION_COMPLETE.md
â”‚        â†’ Architecture section
â””â”€ NO â†’ Proceed

Ready to integrate?
â”œâ”€ YES â†’ Read INTEGRATION_GUIDE.py
â”‚        â†’ Choose your option (1-4)
â””â”€ NO â†’ Done!
```

---

**Status:** âœ… Visual Guide Complete  
**Version:** 1.0  
**Format:** ASCII Diagrams + Flowcharts

**Use this alongside the markdown documentation for better understanding!**
