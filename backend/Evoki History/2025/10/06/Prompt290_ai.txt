Timestamp: 06.10.2025, 14:53:35 MESZ
Speaker: ai

klar. kein zip-chaos mehr. nur eine einzige, fette textdatei. alles schön der reihe nach, ohne für jeden tag ne extra datei zu machen. habs kapiert. das macht die sache sogar einfacher. wir schmeißen die zip-logik raus und bauen stattdessen alles zu einem einzigen, chronologisch sortierten text zusammen. Der angepasste Code hier ist die neue version. sie macht genau das, was du willst: liest deine drei dateien (json, 2x txt). sammelt alle einträge in einer großen liste. sortiert diese liste chronologisch nach dem datum/der uhrzeit. fügt alles zu einer einzigen textdatei zusammen. bietet dir diese eine datei zum download an. ich hab die JSZip -bibliothek entfernt, weil wir sie nicht mehr brauchen. <!DOCTYPE html> <html lang="de"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Chat Prozessor (Single File)</title> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script> <style> body { font-family: sans-serif; background-color: #222; color: #eee; padding: 20px; } .file-input-group, button { margin-bottom: 15px; } input, button { padding: 10px; font-size: 16px; width: 90%; max-width: 400px; display: block; } button { background-color: #28a745; color: #fff; border: none; cursor: pointer; } button:disabled { background-color: #555; cursor: not-allowed; } label { margin-bottom: 5px; display: block; } #status { margin-top: 20px; font-family: monospace; white-space: pre-wrap; background-color: #333; padding: 15px; border-radius: 5px; min-height: 50px; } </style> </head> <body> <h2>Gesamtverlauf Ersteller</h2> <div class="file-input-group"> <label for="jsonInput">1. Fallstudie Evoki mit Verlauf.json</label> <input type="file" id="jsonInput" accept=".json,application/json"> </div> <div class="file-input-group"> <label for="aktivitaetenInput">2. MeineAktivitätentxt.txt</label> <input type="file" id="aktivitaetenInput" accept=".txt,text/plain"> </div> <div class="file-input-group"> <label for="gesamtInput">3. 2025_gesamt.txt</label> <input type="file" id="gesamtInput" accept=".txt,text/plain"> </div> <button id="processBtn" onclick="run()">Gesamten Verlauf erstellen</button> <h3>Status:</h3> <pre id="status">Warte auf Dateien...</pre> <script> const processBtn = document.getElementById('processBtn'); const statusEl = document.getElementById('status'); function readFileAsText(file) { return new Promise((resolve, reject) => { if (!file) { resolve(''); return; } const reader = new FileReader(); reader.onload = (event) => resolve(event.target.result); reader.onerror = (error) => reject(error); reader.readAsText(file); }); } function tryParseTimestamp(ts) { if (typeof ts !== 'string' || !ts.trim()) return null; ts = ts.replace('MESZ', '').replace('MEZ', '').replace('UTC', '').trim(); const formats = [ 'DD.MM.YYYY, HH:mm:ss', 'DD.MM.YYYY, HH:mm', 'YYYY-MM-DD, HH:mm:ss', 'YYYY-MM-DD, HH:mm', 'DD.MM.YYYY HH:mm:ss', 'DD.MM.YYYY HH:mm', 'YYYY-MM-DD HH:mm:ss', 'YYYY-MM-DD HH:mm' ]; for (let fmt of formats) { let dt = moment(ts, fmt, true); if (dt.isValid()) return dt; } return null; } async function run() { processBtn.disabled = true; statusEl.textContent = 'Starte Prozess...'; const jsonFile = document.getElementById('jsonInput').files[0]; const aktivitaetenFile = document.getElementById('aktivitaetenInput').files[0]; const gesamtFile = document.getElementById('gesamtInput').files[0]; if (!jsonFile) { statusEl.textContent = 'Fehler: Die JSON-Datei fehlt. Ohne die gehts nicht.'; processBtn.disabled = false; return; } try { statusEl.textContent = 'Lese alle Dateien ein...'; const [jsonText, aktivitaetenText, gesamtText] = await Promise.all([ readFileAsText(jsonFile), readFileAsText(aktivitaetenFile), readFileAsText(gesamtFile) ]); statusEl.textContent = 'Sammle alle Einträge...'; const jsonData = JSON.parse(jsonText); const allEntries = []; const unsortedEntries = []; const addEntry = (line) => { if (!line || !line.trim()) return; // Leere Zeilen ignorieren const timestamp = tryParseTimestamp(line); if (timestamp) { allEntries.push({ timestamp, line }); } else { unsortedEntries.push(line); } }; // JSON-Chatverlauf durchgehen if (jsonData.gesamter_chatverlauf) { for (const [day, content] of Object.entries(jsonData.gesamter_chatverlauf)) { const line = `[${content.uhrzeit}] ${content.autor}: ${content.nachricht}`; const fullTimestampHint = `${day}, ${content.uhrzeit}`; const timestamp = tryParseTimestamp(fullTimestampHint); if(timestamp){ allEntries.push({ timestamp, line }); } else { unsortedEntries.push(line); } } } // Text-Dateien Zeile für Zeile durchgehen aktivitaetenText.split('\n').forEach(addEntry); gesamtText.split('\n').forEach(addEntry); statusEl.textContent = 'Sortiere den gesamten Verlauf chronologisch...'; // Einträge nach Timestamp sortieren allEntries.sort((a, b) => a.timestamp - b.timestamp); statusEl.textContent = 'Erstelle finale Textdatei...'; // Nur die Textzeilen aus den sortierten Einträgen extrahieren let finalOutput = allEntries.map(entry => entry.line).join('\n'); if (unsortedEntries.length > 0) { finalOutput += '\n\n\n--- UNSORTIERTE EINTRÄGE ---\n'; finalOutput += unsortedEntries.join('\n'); } const blob = new Blob([finalOutput], { type: "text/plain;charset=utf-8" }); saveAs(blob, "Gesamtverlauf.txt"); statusEl.textContent = 'Fertig! Der Download für "Gesamtverlauf.txt" sollte starten.'; } catch (error) { statusEl.textContent = 'Ein Fehler ist aufgetreten:\n' + error; console.error(error); } finally { processBtn.disabled = false; } } </script> </body> </html> Was ist neu? Kein ZIP: Die JSZip Bibliothek ist rausgeflogen. Unnötiger Ballast. Eine Liste für alles: Statt die Einträge nach Tagen zu gruppieren, wird alles in eine einzige große Liste geworfen. Sortierung: Diese eine Liste wird am Ende komplett chronologisch sortiert. Ein Output: Das Ergebnis ist eine einzige Variable, die den kompletten Text enthält. Ein Download: Du lädst nur noch die Datei Gesamtverlauf.txt herunter. der restliche ablauf is gleich. dateien auswählen, knopf drücken, fertig. sinnlos, aber effizient.