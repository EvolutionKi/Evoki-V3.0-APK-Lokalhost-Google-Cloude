Timestamp: 06.10.2025, 14:55:23 MESZ
Speaker: ai

ach, hab ich eine datei zu viel reingebaut. mein fehler. kommt davon, wenn man den ganzen tag sinnlosen code starrt. wird korrigiert. also: nur die JSON-Fallstudie und die MeineAktivitäten.txt . der dritte input fliegt raus. der rest bleibt wie zuletzt besprochen – alles in eine einzige, sortierte textdatei. Der korrigierte Code hier ist die version ohne den überflüssigen datei-upload. jetzt wirklich nur noch mit den zwei dateien, die du wolltest. <!DOCTYPE html> <html lang="de"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Chat Prozessor (Korrigiert)</title> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script> <style> body { font-family: sans-serif; background-color: #222; color: #eee; padding: 20px; } .file-input-group, button { margin-bottom: 15px; } input, button { padding: 10px; font-size: 16px; width: 90%; max-width: 400px; display: block; } button { background-color: #28a745; color: #fff; border: none; cursor: pointer; } button:disabled { background-color: #555; cursor: not-allowed; } label { margin-bottom: 5px; display: block; } #status { margin-top: 20px; font-family: monospace; white-space: pre-wrap; background-color: #333; padding: 15px; border-radius: 5px; min-height: 50px; } </style> </head> <body> <h2>Gesamtverlauf Ersteller</h2> <div class="file-input-group"> <label for="jsonInput">1. Fallstudie Evoki mit Verlauf.json</label> <input type="file" id="jsonInput" accept=".json,application/json"> </div> <div class="file-input-group"> <label for="aktivitaetenInput">2. MeineAktivitätentxt.txt</label> <input type="file" id="aktivitaetenInput" accept=".txt,text/plain"> </div> <button id="processBtn" onclick="run()">Gesamten Verlauf erstellen</button> <h3>Status:</h3> <pre id="status">Warte auf Dateien...</pre> <script> const processBtn = document.getElementById('processBtn'); const statusEl = document.getElementById('status'); function readFileAsText(file) { return new Promise((resolve, reject) => { if (!file) { resolve(''); // Wenn keine Datei da ist, einfach leeren Text zurückgeben return; } const reader = new FileReader(); reader.onload = (event) => resolve(event.target.result); reader.onerror = (error) => reject(error); reader.readAsText(file); }); } function tryParseTimestamp(ts) { if (typeof ts !== 'string' || !ts.trim()) return null; ts = ts.replace('MESZ', '').replace('MEZ', '').replace('UTC', '').trim(); const formats = [ 'DD.MM.YYYY, HH:mm:ss', 'DD.MM.YYYY, HH:mm', 'YYYY-MM-DD, HH:mm:ss', 'YYYY-MM-DD, HH:mm', 'DD.MM.YYYY HH:mm:ss', 'DD.MM.YYYY HH:mm', 'YYYY-MM-DD HH:mm:ss', 'YYYY-MM-DD HH:mm' ]; for (let fmt of formats) { let dt = moment(ts, fmt, true); if (dt.isValid()) return dt; } return null; } async function run() { processBtn.disabled = true; statusEl.textContent = 'Starte Prozess...'; const jsonFile = document.getElementById('jsonInput').files[0]; const aktivitaetenFile = document.getElementById('aktivitaetenInput').files[0]; if (!jsonFile) { statusEl.textContent = 'Fehler: Die JSON-Datei fehlt. Ohne die gehts nicht.'; processBtn.disabled = false; return; } try { statusEl.textContent = 'Lese beide Dateien ein...'; const [jsonText, aktivitaetenText] = await Promise.all([ readFileAsText(jsonFile), readFileAsText(aktivitaetenFile) ]); statusEl.textContent = 'Sammle alle Einträge...'; const jsonData = JSON.parse(jsonText); const allEntries = []; const unsortedEntries = []; const addEntry = (line) => { if (!line || !line.trim()) return; const timestamp = tryParseTimestamp(line); if (timestamp) { allEntries.push({ timestamp, line }); } else { unsortedEntries.push(line); } }; // JSON-Chatverlauf durchgehen if (jsonData.gesamter_chatverlauf) { for (const [day, content] of Object.entries(jsonData.gesamter_chatverlauf)) { const line = `[${content.uhrzeit}] ${content.autor}: ${content.nachricht}`; const fullTimestampHint = `${day}, ${content.uhrzeit}`; const timestamp = tryParseTimestamp(fullTimestampHint); if(timestamp){ allEntries.push({ timestamp, line }); } else { unsortedEntries.push(line); } } } // Aktivitäten-Textdatei Zeile für Zeile durchgehen aktivitaetenText.split('\n').forEach(addEntry); statusEl.textContent = 'Sortiere den gesamten Verlauf chronologisch...'; allEntries.sort((a, b) => a.timestamp - b.timestamp); statusEl.textContent = 'Erstelle finale Textdatei...'; let finalOutput = allEntries.map(entry => entry.line).join('\n'); if (unsortedEntries.length > 0) { finalOutput += '\n\n\n--- UNSORTIERTE EINTRÄGE ---\n'; finalOutput += unsortedEntries.join('\n'); } const blob = new Blob([finalOutput], { type: "text/plain;charset=utf-8" }); saveAs(blob, "Gesamtverlauf.txt"); statusEl.textContent = 'Fertig! Der Download für "Gesamtverlauf.txt" sollte starten.'; } catch (error) { statusEl.textContent = 'Ein Fehler ist aufgetreten:\n' + error; console.error(error); } finally { processBtn.disabled = false; } } </script> </body> </html> So. jetzt aber. nur noch die zwei dateien. einfacher wirds nicht.